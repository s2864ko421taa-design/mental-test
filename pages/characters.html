<!-- pages/characters.html -->
<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>タイプ一覧</title>

  <link rel="stylesheet" href="../css/reset.css">
  <link rel="stylesheet" href="../css/tokens.css">
  <link rel="stylesheet" href="../css/base.css">
  <link rel="stylesheet" href="../css/components.css">
  <link rel="stylesheet" href="../css/index.css">
</head>

<body>
  <header class="topbar">
    <div class="topbar__left">
      <div class="title">タイプ一覧</div>
      <div class="subtitle">32タイプ（U/O・M/C・H/L・D/S・R/X）</div>
    </div>
    <div class="topbar__right topbar__right--safe">
      <a class="btn btn--ghost" href="../index.html">診断へ戻る</a>
    </div>
  </header>

  <main class="wrap">
    <div class="card">
      <div class="muted">カードをタップすると詳細へ移動します（例： type.html?t=OMHSX）。</div>
      <div class="muted" style="margin-top:8px;">
        ● グループ色：<span style="font-weight:700;">U×M / U×C / O×M / O×C</span> の4色
      </div>
    </div>

    <div class="grid" id="grid"></div>
  </main>

  <script type="module">
    import { allTypes, getTypeInfo } from "../js/characters.js";

    const grid = document.getElementById("grid");

    // ✅ 4色固定（U/O × M/C）
    function groupColorFromCode(code) {
      const uo = code?.[0] ?? "";
      const mc = code?.[1] ?? "";
      const key = `${uo}${mc}`; // UM / UC / OM / OC

      const map = {
        UM: "hsl(200 85% 60%)", // U×M
        UC: "hsl(160 85% 55%)", // U×C
        OM: "hsl(40  90% 60%)", // O×M
        OC: "hsl(290 85% 65%)", // O×C
      };

      return map[key] ?? "rgba(255,255,255,.35)";
    }

    // グループ表示名も固定で分かりやすく
    function groupNameFromCode(code) {
      const uo = code?.[0] === "U" ? "外側処理" : "内側処理";
      const mc = code?.[1] === "M" ? "適応" : "非適応";
      return `${uo}×${mc}`;
    }

    function card(t) {
      const info = getTypeInfo(t) || {};
      const code = info.code ?? t;

      const a = document.createElement("a");
      a.href = `./type.html?t=${encodeURIComponent(code)}`;
      a.className = "card";
      a.style.display = "block";

      // 上段（グループ + ドット）
      const top = document.createElement("div");
      top.style.display = "flex";
      top.style.alignItems = "center";
      top.style.justifyContent = "space-between";
      top.style.gap = "10px";

      const tag = document.createElement("div");
      tag.className = "badge";
      tag.textContent = groupNameFromCode(code); // ✅ ここで「GROUP」じゃなく実名

      const dot = document.createElement("div");
      dot.style.width = "12px";
      dot.style.height = "12px";
      dot.style.borderRadius = "999px";
      dot.style.background = groupColorFromCode(code); // ✅ 4色固定
      dot.style.border = "1px solid rgba(255,255,255,.18)";

      top.appendChild(tag);
      top.appendChild(dot);

      // 1行目：コード
      const title = document.createElement("div");
      title.style.fontSize = "22px";
      title.style.fontWeight = "900";
      title.style.marginTop = "10px";
      title.textContent = code;

      // 2行目：日本語名（キャラ名）
      const jp = document.createElement("div");
      jp.className = "muted";
      jp.style.marginTop = "6px";
      jp.textContent = info?.label ?? info?.name ?? ""; // characters.js は label を返す

      // 3行目：軸の説明
      const sub = document.createElement("div");
      sub.className = "muted";
      sub.style.marginTop = "6px";
      sub.textContent = info?.axesText ?? "";

      a.appendChild(top);
      a.appendChild(title);
      if (jp.textContent) a.appendChild(jp);
      if (sub.textContent) a.appendChild(sub);

      return a;
    }

    // grid style（このページだけで完結させる）
    grid.style.display = "grid";
    grid.style.gridTemplateColumns = "repeat(2, minmax(0, 1fr))";
    grid.style.gap = "12px";
    grid.style.marginTop = "12px";

    for (const t of allTypes) grid.appendChild(card(t));
  </script>
</body>
</html>
